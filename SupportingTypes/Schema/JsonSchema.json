{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://github.com/supernova/mql5-indexer/financial-assets-schema.json",
  "title": "Financial Assets Index Schema",
  "description": "JSON Schema for Financial Assets Index exported from MQL5",
  "version": "1.0.0",
  "type": "object",
  "properties": {
    "financial_assets": {
      "type": "array",
      "description": "Array of financial asset objects",
      "items": {
        "$ref": "#/definitions/FinancialAsset"
      },
      "minItems": 0
    },
    "total_assets": {
      "type": "integer",
      "description": "Total number of assets in the index",
      "minimum": 0
    },
    "export_date": {
      "type": "string",
      "description": "ISO 8601 formatted export timestamp",
      "format": "date-time"
    },
    "enum_definitions": {
      "type": "object",
      "description": "Dynamic enum definitions for market symbols",
      "patternProperties": {
        "^SYMBOL_": {
          "type": "integer",
          "description": "Enum value for symbol",
          "minimum": 0
        }
      },
      "additionalProperties": false
    },
    "metadata": {
      "type": "object",
      "description": "Additional metadata about the export",
      "properties": {
        "version": {
          "type": "string",
          "description": "Schema version"
        },
        "exporter": {
          "type": "string",
          "description": "Name of the exporting system",
          "default": "MQL5 Financial Assets Indexer"
        },
        "asset_types": {
          "$ref": "#/definitions/AssetTypeStatistics"
        }
      }
    }
  },
  "required": ["financial_assets", "total_assets", "export_date"],
  "definitions": {
    "FinancialAsset": {
      "type": "object",
      "description": "Represents a single financial asset",
      "properties": {
        "serial_number": {
          "type": "integer",
          "description": "Unique serial number for the asset",
          "minimum": 1
        },
        "asset_name": {
          "type": "string",
          "description": "Original asset symbol name (e.g., EURUSD, AAPL)",
          "minLength": 1,
          "maxLength": 32,
          "pattern": "^[A-Z0-9_.]+$"
        },
        "normalized_name": {
          "type": "string",
          "description": "Normalized name for enum generation (e.g., SYMBOL_EURUSD)",
          "minLength": 8,
          "maxLength": 64,
          "pattern": "^SYMBOL_[A-Z0-9_]+$"
        },
        "enum_symbol": {
          "type": "integer",
          "description": "Numeric enum value for the symbol",
          "minimum": 0
        },
        "asset_type": {
          "type": "integer",
          "description": "Asset type classification",
          "minimum": 0,
          "maximum": 5
        },
        "asset_type_name": {
          "type": "string",
          "description": "Human-readable asset type name",
          "enum": [
            "FOREX",
            "STOCK",
            "INDEX",
            "COMMODITY",
            "CRYPTO",
            "UNKNOWN"
          ]
        },
        "timestamp": {
          "type": "string",
          "description": "ISO 8601 formatted timestamp when asset was added",
          "format": "date-time"
        },
        "properties": {
          "type": "object",
          "description": "Additional asset properties",
          "additionalProperties": true
        }
      },
      "required": ["serial_number", "asset_name", "normalized_name", "enum_symbol", "asset_type", "timestamp"]
    },
    "AssetTypeStatistics": {
      "type": "object",
      "description": "Statistics by asset type",
      "properties": {
        "forex_pairs": {
          "type": "integer",
          "minimum": 0
        },
        "stocks": {
          "type": "integer",
          "minimum": 0
        },
        "indices": {
          "type": "integer",
          "minimum": 0
        },
        "commodities": {
          "type": "integer",
          "minimum": 0
        },
        "cryptocurrencies": {
          "type": "integer",
          "minimum": 0
        },
        "unknown": {
          "type": "integer",
          "minimum": 0
        }
      }
    }
  },
  "additionalProperties": false
}